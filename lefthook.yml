# Lefthook configuration for MCP Tools for Obsidian
# Install: brew install lefthook && lefthook install

pre-commit:
  parallel: true
  commands:
    typecheck:
      glob: "*.{ts,tsx,svelte}"
      run: bun run check
      stage_fixed: true

    test:
      glob: "*.{ts,tsx}"
      run: bun test --bail
      stage_fixed: true

pre-push:
  parallel: true
  commands:
    typecheck:
      run: bun run check

    test:
      run: bun test

commit-msg:
  commands:
    conventional-commit:
      run: |
        # Validate conventional commit format
        message=$(cat {1})
        pattern="^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\(.+\))?: .+"
        if ! echo "$message" | grep -qE "$pattern"; then
          echo "‚ùå Commit message must follow Conventional Commits format:"
          echo "   type(scope): description"
          echo ""
          echo "   Types: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert"
          echo ""
          echo "   Your message: $message"
          exit 1
        fi
